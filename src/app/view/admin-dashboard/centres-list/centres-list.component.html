<html lang="fr">

<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/7.2.0/mdb.min.css" rel="stylesheet">
</head>

<body>
  <!-- Sidebar -->
  <div class="sidebar" id="sidebar">
    <div class="logo">
      <i class="fas fa-hashtag"></i> AUTOWASH
    </div>
    <div class="user-profile">
      <img
        src="https://media.licdn.com/dms/image/v2/D4E03AQFl4HpioZZvhQ/profile-displayphoto-shrink_200_200/profile-displayphoto-shrink_200_200/0/1722776592369?e=1752105600&v=beta&t=rO8ASWATTrkWn2YaWXch8SnDzwUcyCtDkcAJsdEQ2n4"
        alt="User Profile">
      <div class="user-info">
        <h4>Afffery Auxence Delors CHABEHOU<span class="status-indicator"></span></h4>
        <p>Administrateur</p>
      </div>
    </div>
    <div class="nav-menu">
      <!-- Dashboard -->
      <div class="dropdown dropdown-hover">
        <a class="nav-item active" [routerLink]="['/admin/dashboard']" data-mdb-dropdown-init>
          <i class="fas fa-tachometer-alt"></i>
          <span>Tableau de bord</span>
        </a>
      </div>

      <!-- Gestion des Utilisateurs -->
      <div class="dropdown dropdown-hover">
        <button class="nav-item" data-mdb-dropdown-init>
          <i class="fas fa-users-cog"></i>
          <span>Utilisateurs</span>
          <i class="fas fa-chevron-right dropdown-arrow"></i>
        </button>
        <ul class="dropdown-menu dropdown-menu-hover">
          <li><a class="dropdown-item" [routerLink]="['/admin/users-list']"><i class="fas fa-list"></i> Liste des
              utilisateurs</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/users-create']"><i class="fas fa-user-plus"></i> Ajouter
              un utilisateur</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/users-permissions']"><i class="fas fa-user-shield"></i>
              Permissions</a></li>
        </ul>
      </div>

      <!-- Centres de Lavage -->
      <div class="dropdown dropdown-hover">
        <button class="nav-item" data-mdb-dropdown-init>
          <i class="fa-solid fa-car"></i>
          <span>Centres</span>
          <i class="fas fa-chevron-right dropdown-arrow"></i>
        </button>
        <ul class="dropdown-menu dropdown-menu-hover">
          <li><a class="dropdown-item" [routerLink]="['/admin/centres-list']"><i class="fas fa-list"></i> Tous les
              centres</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/centres-create']"><i class="fas fa-plus-circle"></i>
              Nouveau centre</a></li>
        </ul>
      </div>

      <!-- Statistiques & Rapports -->
      <div class="dropdown dropdown-hover">
        <button class="nav-item" data-mdb-dropdown-init>
          <i class="fas fa-chart-pie"></i>
          <span>Statistiques</span>
          <i class="fas fa-chevron-right dropdown-arrow"></i>
        </button>
        <ul class="dropdown-menu dropdown-menu-hover">
          <li><a class="dropdown-item" href="#"><i class="fas fa-calendar-day"></i> Journalier</a></li>
          <li><a class="dropdown-item" href="#"><i class="fas fa-calendar-week"></i> Hebdomadaire</a></li>
          <li><a class="dropdown-item" href="#"><i class="fas fa-calendar-alt"></i> Mensuel</a></li>
          <li><a class="dropdown-item" href="#"><i class="fas fa-file-export"></i> Exports</a></li>
          <li><a class="dropdown-item" href="#"><i class="fas fa-balance-scale"></i> Comparaison</a></li>
        </ul>
      </div>

      <!-- Tarification -->
      <div class="dropdown dropdown-hover">
        <button class="nav-item" data-mdb-dropdown-init>
          <i class="fas fa-tags"></i>
          <span>Tarification</span>
          <i class="fas fa-chevron-right dropdown-arrow"></i>
        </button>
        <ul class="dropdown-menu dropdown-menu-hover">
          <li><a class="dropdown-item" href="#"><i class="fas fa-car"></i> Par véhicule</a></li>
          <li><a class="dropdown-item" href="#"><i class="fas fa-concierge-bell"></i> Par prestation</a></li>
          <li><a class="dropdown-item" href="#"><i class="fas fa-percentage"></i> Remises</a></li>
        </ul>
      </div>

      <!-- Dépenses -->
      <div class="dropdown dropdown-hover">
        <button class="nav-item" data-mdb-dropdown-init>
          <i class="fas fa-file-invoice-dollar"></i>
          <span>Dépenses</span>
          <i class="fas fa-chevron-right dropdown-arrow"></i>
        </button>
        <ul class="dropdown-menu dropdown-menu-hover">
          <li><a class="dropdown-item" href="#"><i class="fas fa-tint"></i> Eau/Électricité</a></li>
          <li><a class="dropdown-item" href="#"><i class="fas fa-shopping-basket"></i> Produits</a></li>
          <li><a class="dropdown-item" href="#"><i class="fas fa-home"></i> Loyer</a></li>
          <li><a class="dropdown-item" href="#"><i class="fas fa-chart-line"></i> Rentabilité</a></li>
        </ul>
      </div>

      <!-- Journal d'Activité -->
      <div class="dropdown dropdown-hover">
        <a class="nav-item" data-mdb-dropdown-init>
          <i class="fas fa-clipboard-list"></i>
          <span>Journal d'activité</span>
        </a>
      </div>

      <!-- Paramètres -->
      <div class="dropdown dropdown-hover">
        <button class="nav-item" data-mdb-dropdown-init>
          <i class="fas fa-cogs"></i>
          <span>Paramètres</span>
          <i class="fas fa-chevron-right dropdown-arrow"></i>
        </button>
        <ul class="dropdown-menu dropdown-menu-hover">
          <li><a class="dropdown-item" href="#"><i class="fas fa-clock"></i> Horaires</a></li>
          <li><a class="dropdown-item" href="#"><i class="fas fa-list-alt"></i> Types de prestations</a></li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content" id="main-content">
    <div class="top-bar">
      <div class="menu-toggle" id="menu-toggle">
        <i class="fas fa-bars"></i>
      </div>
      <div class="search-box">
        <input type="text"
          class="w-full pl-10 pr-4 py-2 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200"
          placeholder="Rechercher un centre..." [(ngModel)]="searchTerm" (ngModelChange)="filterCentre()" />
      </div>
      <div class="top-right">
        <div class="icon-button">
          <i class="fas fa-envelope"></i>
        </div>
        <div class="icon-button">
          <i class="fas fa-bell"></i>
          <span class="badge">3</span>
        </div>
        <div class="dropdown dropdown-hover">
          <button class="user-dropdown" id="user-dropdown" data-mdb-dropdown-init>
            <img src="https://via.placeholder.com/32" alt="User">
            <span>Affery Auxence Delors CHABEHOU</span>
            <i class="fas fa-chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-hover" id="user-dropdown-menu">
            <li><a class="dropdown-item" href="#"><i class="fas fa-user"></i> Mon profil</a></li>
            <li><a class="dropdown-item" href="#"><i class="fas fa-cog"></i> Paramètres</a></li>
            <li><a class="dropdown-item" href="#"><i class="fas fa-envelope"></i> Inbox</a></li>
            <li>
              <a class="dropdown-item" (click)="logout()">
                <i class="fas fa-sign-out-alt"></i> Déconnexion
              </a>
            </li>

          </ul>
        </div>
      </div>
    </div>

    <div class="page-content">
      <div class="blank-page">
        <div class="page-content">
          <div class="users-table-container">
            <div class="table-header">
              <div class="table-title">Liste des centres</div>
              <div class="table-actions">
                <button class="btn-action btn-outline">
                  <i class="fas fa-filter btn-icon"></i>Filtrer
                </button>
                <button (click)="exportCentre()" class="btn-action btn-outline">
                  <i class="fas fa-download btn-icon"></i>Exporter
                </button>
                <button [routerLink]="['/admin/centres-create']" class="btn-action btn-primary">
                  <i class="fas fa-plus btn-icon"></i>Ajouter un centre
                </button>
              </div>
            </div>

            <table class="users-table">
              <thead>
                <tr>
                  <th>Nom du centre</th>
                  <th>Precision sur la localisation</th>
                  <th>Gerant du centre</th>
                  <th>Nombres d'employé du centre</th>
                  <th>Statut</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let centre of displayedCentre">
                  <td>
                    <div class="user-info-cell">
                      <div>
                        <div class="user-name">{{ centre?.name }}</div>
                        <div class="user-img"></div>
                      </div>
                    </div>
                  </td>
                  <td>{{ centre?.location }}</td>
                  <td>{{ centre?.ownerName }}</td>
                  <td>A determiner</td>
                  <td>
                    <span class="status" [class.status-active]="centre?.isActive"
                      [class.status-inactive]="!centre?.isActive">
                      {{ centre?.isActive ? 'Actif' : 'Inactif' }}
                    </span>
                  </td>
                  <td>
                    <div class="actions-cell">
                      <!-- Vérification explicite que centre.id existe -->
                      <button *ngIf="centre.id" (click)="deleteCentre(centre.id)" class="btn-toggle"
                        [class.active]="centre?.isActive" title="{{ centre?.isActive ? 'Désactiver' : 'Activer' }}">
                        <span class="toggle-thumb"></span>
                      </button>
                      <!-- Message si l'ID est manquant (optionnel) -->
                      <span *ngIf="!centre.id" class="error-text">ID manquant</span>
                      <!-- Notification Toast -->
                      <div class="notification-toast" *ngIf="notification.show"
                        [class.success]="notification.type === 'success'" [class.error]="notification.type === 'error'">
                        <div class="notification-content">
                          <i class="icon" [class.fa-check-circle]="notification.type === 'success'"
                            [class.fa-exclamation-circle]="notification.type === 'error'"></i>
                          <span>{{ notification.message }}</span>
                        </div>
                        <button class="close-btn" (click)="hideNotification()">
                          <i class="fa fa-times"></i>
                        </button>
                      </div>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>

            <app-confirm-dialog
              [visible]="showConfirmDialog"
              title="Désactivation de centre"
              message="Voulez-vous vraiment désactiver ce centre ?"
              details="Cette action est irréversible, vous ne pourrez pas réactiver ce centre par la suite."
              confirmText="Désactiver"
              cancelText="Annuler"
              (confirm)="onConfirmDelete()"
              (cancel)="showConfirmDialog = false">
            </app-confirm-dialog>

            <div class="table-pagination">
              <div class="pagination-info">
                Page {{ currentPage }} sur {{ totalPages }} • Nombre de centre = {{ totalItems }} centre(s)
              </div>
              <div class="pagination-controls">
                <button (click)="previousPage()" [disabled]="currentPage === 1" class="pagination-btn">
                  <i class="fas fa-angle-double-left"></i>
                </button>
                <button (click)="nextPage()" [disabled]="currentPage === totalPages" class="pagination-btn">
                  <i class="fas fa-angle-double-right"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="footer">
      <div>©2025 AutoWash, Tous droit reservé.</div>
      <div>Crée par <a href="https://www.linkedin.com/in/afferyauxencedelorschabehou/">Affery Auxence Delors
          CHABEHOU</a></div>
    </div>
  </div>
</body>

</html>
