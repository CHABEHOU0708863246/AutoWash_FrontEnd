<html lang="fr">

<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/7.2.0/mdb.min.css" rel="stylesheet">
</head>

<body>
  <!-- Sidebar -->
  <div class="sidebar" id="sidebar">
    <div class="logo">
      <i class="fas fa-hashtag"></i> AUTOWASH
    </div>
    <div class="user-profile">
      <img
        src="https://media.licdn.com/dms/image/v2/D4E03AQFl4HpioZZvhQ/profile-displayphoto-shrink_200_200/profile-displayphoto-shrink_200_200/0/1722776592369?e=1752105600&v=beta&t=rO8ASWATTrkWn2YaWXch8SnDzwUcyCtDkcAJsdEQ2n4"
        alt="User Profile">
      <div class="user-info">
        <h4>Afffery Auxence Delors CHABEHOU<span class="status-indicator"></span></h4>
        <p>Administrateur</p>
      </div>
    </div>
    <div class="nav-menu">
      <!-- Dashboard -->
      <div class="dropdown dropdown-hover">
        <a class="nav-item active" data-mdb-dropdown-init>
          <i class="fas fa-tachometer-alt" [routerLink]="['/admin/dashboard']"></i>
          <span>Tableau de bord</span>
        </a>
      </div>

      <!-- Gestion des Utilisateurs -->
      <div class="dropdown dropdown-hover">
        <button class="nav-item" data-mdb-dropdown-init>
          <i class="fas fa-users-cog"></i>
          <span>Utilisateurs</span>
          <i class="fas fa-chevron-right dropdown-arrow"></i>
        </button>
        <ul class="dropdown-menu dropdown-menu-hover">
          <li><a class="dropdown-item" [routerLink]="['/admin/users-list']"><i class="fas fa-list"></i> Liste des
              utilisateurs</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/users-create']"><i class="fas fa-user-plus"></i> Ajouter
              un utilisateur</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/users-permissions']"><i class="fas fa-user-shield"></i>
              Permissions</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/users-attendance']"><i class="fas fa-user-clock"></i>
              Présences</a></li>
        </ul>
      </div>

      <!-- Centres de Lavage -->
      <div class="dropdown dropdown-hover">
        <button class="nav-item" data-mdb-dropdown-init>
          <i class="fa-solid fa-car"></i>
          <span>Centres</span>
          <i class="fas fa-chevron-right dropdown-arrow"></i>
        </button>
        <ul class="dropdown-menu dropdown-menu-hover">
          <li><a class="dropdown-item" [routerLink]="['/admin/centres-list']"><i class="fas fa-list"></i> Tous les
              centres</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/centres-create']"><i class="fas fa-plus-circle"></i>
              Nouveau centre</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/centres-stock']"><i class="fas fa-boxes"></i> Stocks par
              centre</a></li>
        </ul>
      </div>

      <!-- Sessions de Lavage -->
      <div class="dropdown dropdown-hover">
        <button class="nav-item" data-mdb-dropdown-init>
          <i class="fas fa-car-side"></i>
          <span>Lavages</span>
          <i class="fas fa-chevron-right dropdown-arrow"></i>
        </button>
        <ul class="dropdown-menu dropdown-menu-hover">
          <li><a class="dropdown-item" [routerLink]="['/admin/wash-sessions']"><i class="fas fa-list"></i> Toutes les
              sessions</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/wash-now']"><i class="fas fa-play-circle"></i> Nouveau
              lavage</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/wash-queue']"><i class="fas fa-clock"></i> File
              d'attente</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/wash-types']"><i class="fas fa-list-alt"></i> Types de
              lavage</a></li>
        </ul>
      </div>

      <!-- Paiements -->
      <div class="dropdown dropdown-hover">
        <button class="nav-item" data-mdb-dropdown-init>
          <i class="fas fa-money-bill-wave"></i>
          <span>Paiements</span>
          <i class="fas fa-chevron-right dropdown-arrow"></i>
        </button>
        <ul class="dropdown-menu dropdown-menu-hover">
          <li><a class="dropdown-item" [routerLink]="['/admin/payments-washers']"><i class="fas fa-user-tie"></i>
              Paiements laveurs</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/payments-customers']"><i class="fas fa-users"></i>
              Paiements clients</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/payments-methods']"><i class="fas fa-credit-card"></i>
              Méthodes de paiement</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/payments-reports']"><i
                class="fas fa-file-invoice-dollar"></i> Rapports</a></li>
        </ul>
      </div>

      <!-- Stocks -->
      <div class="dropdown dropdown-hover">
        <button class="nav-item" data-mdb-dropdown-init>
          <i class="fas fa-box-open"></i>
          <span>Stocks</span>
          <i class="fas fa-chevron-right dropdown-arrow"></i>
        </button>
        <ul class="dropdown-menu dropdown-menu-hover">
          <li><a class="dropdown-item" [routerLink]="['/admin/stocks-list']"><i class="fas fa-boxes"></i> Inventaire</a>
          </li>
          <li><a class="dropdown-item" [routerLink]="['/admin/stocks-alerts']"><i
                class="fas fa-exclamation-triangle"></i> Alertes stock</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/stocks-movements']"><i class="fas fa-exchange-alt"></i>
              Mouvements</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/stocks-suppliers']"><i class="fas fa-truck"></i>
              Fournisseurs</a></li>
        </ul>
      </div>

      <!-- Statistiques & Rapports -->
      <div class="dropdown dropdown-hover">
        <button class="nav-item" data-mdb-dropdown-init>
          <i class="fas fa-chart-pie"></i>
          <span>Statistiques</span>
          <i class="fas fa-chevron-right dropdown-arrow"></i>
        </button>
        <ul class="dropdown-menu dropdown-menu-hover">
          <li><a class="dropdown-item" [routerLink]="['/admin/reports-daily']"><i class="fas fa-calendar-day"></i>
              Journalier</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/reports-weekly']"><i class="fas fa-calendar-week"></i>
              Hebdomadaire</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/reports-monthly']"><i class="fas fa-calendar-alt"></i>
              Mensuel</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/reports-comparison']"><i class="fas fa-balance-scale"></i>
              Comparaison</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/reports-export']"><i class="fas fa-file-export"></i>
              Exports</a></li>
        </ul>
      </div>

      <!-- Audit -->
      <div class="dropdown dropdown-hover">
        <button class="nav-item" data-mdb-dropdown-init>
          <i class="fas fa-clipboard-check"></i>
          <span>Audit</span>
          <i class="fas fa-chevron-right dropdown-arrow"></i>
        </button>
        <ul class="dropdown-menu dropdown-menu-hover">
          <li><a class="dropdown-item" [routerLink]="['/admin/audit-logs']"><i class="fas fa-clipboard-list"></i>
              Journal d'activité</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/audit-changes']"><i class="fas fa-history"></i> Historique
              modifications</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/audit-security']"><i class="fas fa-shield-alt"></i>
              Sécurité</a></li>
        </ul>
      </div>

      <!-- Dépenses -->
      <div class="dropdown dropdown-hover">
        <button class="nav-item" data-mdb-dropdown-init>
          <i class="fas fa-file-invoice-dollar"></i>
          <span>Dépenses</span>
          <i class="fas fa-chevron-right dropdown-arrow"></i>
        </button>
        <ul class="dropdown-menu dropdown-menu-hover">
          <li><a class="dropdown-item" [routerLink]="['/admin/expenses-utilities']"><i class="fas fa-tint"></i>
              Eau/Électricité</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/expenses-products']"><i
                class="fas fa-shopping-basket"></i> Produits</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/expenses-rent']"><i class="fas fa-home"></i> Loyer</a>
          </li>
          <li><a class="dropdown-item" [routerLink]="['/admin/expenses-other']"><i class="fas fa-receipt"></i>
              Divers</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/expenses-profitability']"><i
                class="fas fa-chart-line"></i> Rentabilité</a></li>
        </ul>
      </div>

      <!-- Paramètres -->
      <div class="dropdown dropdown-hover">
        <button class="nav-item" data-mdb-dropdown-init>
          <i class="fas fa-cogs"></i>
          <span>Paramètres</span>
          <i class="fas fa-chevron-right dropdown-arrow"></i>
        </button>
        <ul class="dropdown-menu dropdown-menu-hover">
          <li><a class="dropdown-item" [routerLink]="['/admin/settings-schedule']"><i class="fas fa-clock"></i>
              Horaires</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/settings-services']"><i class="fas fa-concierge-bell"></i>
              Prestations</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/settings-vehicles']"><i class="fas fa-car"></i> Types de
              véhicules</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/settings-pricing']"><i class="fas fa-tags"></i>
              Tarification</a></li>
          <li><a class="dropdown-item" [routerLink]="['/admin/settings-system']"><i class="fas fa-sliders-h"></i>
              Système</a></li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content" id="main-content">
    <div class="top-bar">
      <div class="menu-toggle" id="menu-toggle">
        <i class="fas fa-bars"></i>
      </div>
      <div class="top-right">
        <div class="icon-button">
          <i class="fas fa-envelope"></i>
        </div>
        <div class="icon-button">
          <i class="fas fa-bell"></i>
          <span class="badge">3</span>
        </div>
        <div class="dropdown dropdown-hover">
          <button class="user-dropdown" id="user-dropdown" data-mdb-dropdown-init>
            <img src="https://via.placeholder.com/32" alt="User">
            <span>Affery Auxence Delors CHABEHOU</span>
            <i class="fas fa-chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-hover" id="user-dropdown-menu">
            <li><a class="dropdown-item" href="#"><i class="fas fa-user"></i> Mon profil</a></li>
            <li><a class="dropdown-item" href="#"><i class="fas fa-cog"></i> Paramètres</a></li>
            <li><a class="dropdown-item" href="#"><i class="fas fa-envelope"></i> Inbox</a></li>
            <li><a class="dropdown-item" (click)="logout()"><i class="fas fa-sign-out-alt"></i> Déconnexion</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="page-content">
      <div class="header-section">
        <h1>Paramètres des Prestations</h1>
        <p class="subtitle">Gérez les services proposés par votre centre</p>
      </div>

      <!-- Messages d'erreur et de succès -->
      <div class="messages" *ngIf="errorMessage || successMessage">
        <div class="alert alert-danger" *ngIf="errorMessage" role="alert">
          <i class="fas fa-exclamation-triangle"></i>
          {{ errorMessage }}
          <button type="button" class="btn-close" (click)="clearMessages()">×</button>
        </div>
        <div class="alert alert-success" *ngIf="successMessage" role="alert">
          <i class="fas fa-check-circle"></i>
          {{ successMessage }}
          <button type="button" class="btn-close" (click)="clearMessages()">×</button>
        </div>
      </div>

      <!-- Formulaire de création/modification -->
      <div class="form-section" id="service-form">
        <div class="card">
          <div class="card-header">
            <h3>{{ isEditing ? 'Modifier la prestation' : 'Nouvelle prestation' }}</h3>
            <button *ngIf="isEditing" type="button" class="btn btn-secondary btn-sm" (click)="cancelEdit()">
              <i class="fas fa-times"></i> Annuler
            </button>
          </div>

          <div class="card-body">
            <form [formGroup]="serviceForm" (ngSubmit)="onSubmit()">
              <div class="form-row">
                <!-- Nom de la prestation -->
                <div class="form-group">
                  <label for="name">Nom de la prestation *</label>
                  <input id="name" type="text" class="form-control" [class.is-invalid]="hasFieldError('name')"
                    formControlName="name" placeholder="Ex: Lavage extérieur complet">
                  <div class="invalid-feedback" *ngIf="hasFieldError('name')">
                    {{ getFieldError('name') }}
                  </div>
                </div>

                <!-- Catégorie -->
                <div class="form-group">
                  <label for="category">Catégorie *</label>
                  <select id="category" class="form-control" [class.is-invalid]="hasFieldError('category')"
                    formControlName="category">
                    <option value="" disabled>Sélectionner une catégorie</option>
                    <option *ngFor="let category of categories" [value]="category.value">
                      {{ category.label }}
                    </option>
                  </select>
                  <div class="invalid-feedback" *ngIf="hasFieldError('category')">
                    {{ getFieldError('category') }}
                  </div>
                </div>
              </div>

              <!-- Description -->
              <div class="form-group">
                <label for="description">Description</label>
                <textarea id="description" class="form-control" formControlName="description" rows="3"
                  placeholder="Description détaillée de la prestation..."></textarea>
              </div>

              <div class="form-row">
                <!-- Prix de base -->
                <div class="form-group">
                  <label for="basePrice">Prix de base (FCFA d'afrique de l'ouest) *</label>
                  <input id="basePrice" type="number" class="form-control"
                    [class.is-invalid]="hasFieldError('basePrice')" formControlName="basePrice" step="0.01" min="0"
                    placeholder="0.00">
                  <div class="invalid-feedback" *ngIf="hasFieldError('basePrice')">
                    {{ getFieldError('basePrice') }}
                  </div>
                </div>

                <!-- Durée -->
                <div class="form-group">
                  <label for="duration">Durée (minutes) *</label>
                  <input id="duration" type="number" class="form-control" [class.is-invalid]="hasFieldError('duration')"
                    formControlName="duration" min="1" placeholder="30">
                  <div class="invalid-feedback" *ngIf="hasFieldError('duration')">
                    {{ getFieldError('duration') }}
                  </div>
                </div>

                <!-- Nombre maximum concurrent -->
                <div class="form-group">
                  <label for="maxConcurrent">Services simultanés max *</label>
                  <input id="maxConcurrent" type="number" class="form-control"
                    [class.is-invalid]="hasFieldError('maxConcurrent')" formControlName="maxConcurrent" min="1"
                    placeholder="1">
                  <div class="invalid-feedback" *ngIf="hasFieldError('maxConcurrent')">
                    {{ getFieldError('maxConcurrent') }}
                  </div>
                </div>
              </div>

              <div class="form-row">
                <!-- Service actif -->
                <div class="form-group">
                  <div class="form-check">
                    <input id="isActive" type="checkbox" class="form-check-input" formControlName="isActive">
                    <label class="form-check-label" for="isActive">
                      Service actif
                    </label>
                  </div>
                </div>

                <!-- Nécessite approbation -->
                <div class="form-group">
                  <div class="form-check">
                    <input id="requiresApproval" type="checkbox" class="form-check-input"
                      formControlName="requiresApproval">
                    <label class="form-check-label" for="requiresApproval">
                      Nécessite une approbation
                    </label>
                  </div>
                </div>
              </div>

              <div class="form-actions">
                <button type="submit" class="btn btn-primary" [disabled]="isLoading || serviceForm.invalid">
                  <i class="fas fa-spinner fa-spin" *ngIf="isLoading"></i>
                  <i class="fas fa-save" *ngIf="!isLoading"></i>
                  {{ isEditing ? 'Mettre à jour' : 'Créer la prestation' }}
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Liste des prestations -->
      <div class="services-section">
        <div class="card">
          <div class="card-header">
            <h3>Prestations existantes</h3>
            <span class="badge badge-info">{{ services.length }} prestation(s)</span>
          </div>

          <div class="card-body">
            <div *ngIf="isLoading && services.length === 0" class="loading-state">
              <i class="fas fa-spinner fa-spin"></i>
              Chargement des prestations...
            </div>

            <div *ngIf="!isLoading && services.length === 0" class="empty-state">
              <i class="fas fa-concierge-bell"></i>
              <h4>Aucune prestation configurée</h4>
              <p>Commencez par créer votre première prestation de service.</p>
            </div>

            <div *ngIf="services.length > 0" class="services-grid">
              <div *ngFor="let service of services" class="service-card">
                <div class="service-header">
                  <div class="service-info">
                    <h4>{{ service.name }}</h4>
                    <span class="service-category {{ getCategoryClass(service.category) }}">
  {{ getCategoryLabel(service.category) }}
</span>
                  </div>
                  <div class="service-status">
                    <span class="status-badge" [class.active]="service.isActive" [class.inactive]="!service.isActive">
                      {{ service.isActive ? 'Actif' : 'Inactif' }}
                    </span>
                  </div>
                </div>

                <div class="service-body">
                  <p *ngIf="service.description" class="service-description">
                    {{ service.description }}
                  </p>

                  <div *ngIf="service.requiresApproval" class="approval-required">
                    <i class="fas fa-check-circle"></i>
                    Approbation requise
                  </div>
                </div>

                <div class="service-actions">
                  <button type="button" class="btn btn-sm btn-outline-primary" (click)="editService(service)">
                    <i class="fas fa-edit"></i>
                    Modifier
                  </button>

                  <button type="button" class="btn btn-sm" [class.btn-outline-success]="!service.isActive"
                    [class.btn-outline-warning]="service.isActive">
                    <i class="fas" [class.fa-play]="!service.isActive" [class.fa-pause]="service.isActive"></i>
                    {{ service.isActive ? 'Désactiver' : 'Activer' }}
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="footer">
      <div>©2025 AutoWash, Tous droit reservé.</div>
      <div>Crée par <a href="https://www.linkedin.com/in/afferyauxencedelorschabehou/">Affery Auxence Delors
          CHABEHOU</a></div>
    </div>
  </div>
</body>

</html>
